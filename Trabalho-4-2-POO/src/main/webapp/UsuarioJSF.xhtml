<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets">

<ui:composition template="template.xhtml">

    <ui:define name="title">P√°gina do Usu√°rio</ui:define>

    <ui:define name="content">

        <style>
            .user-card {
                background: #ffffff;
                padding: 30px;
                max-width: 600px;
                margin: 0 auto;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.08);
                font-family: Arial;
            }

            .section-title {
                font-size: 1.6rem;
                font-weight: bold;
                color: #2c3e50;
                margin-bottom: 20px;
                text-align: center;
            }

            .label {
                font-weight: bold;
                color: #2c3e50;
                display: block;
                margin-top: 10px;
            }

            .input-field {
                width: 100%;
                padding: 8px 10px;
                border-radius: 6px;
                border: 1px solid #ccc;
                margin-top: 5px;
                box-sizing: border-box;
                margin-bottom: 10px;
            }

            .btn {
                padding: 10px 18px;
                border-radius: 8px;
                border: none;
                cursor: pointer;
                font-size: 1rem;
                transition: 0.2s;
            }

            .btn-green {
                background: #27ae60;
                color: white;
                margin-top: 5px;
            }
            .btn-green:hover {
                background: #1e8449;
            }

            .btn-blue {
                background: #2980b9;
                color: white;
                margin-top: 5px;
            }
            .btn-blue:hover {
                background: #1f618d;
            }

            .info-box {
                background: #f7f7f7;
                border-radius: 8px;
                padding: 15px;
                margin-bottom: 25px;
            }
        </style>

        <div class="user-card" rendered="#{loginBean.usuarioLogado.logado and loginBean.usuarioLogado != null}">

            <div class="section-title">üë§ Informa√ß√µes do Usu√°rio</div>

            <div class="info-box">
                <h:form>
                    <p><span class="label">Nome:</span> #{usuarioBean.usuarioAtual.nome}</p>
                    <p><span class="label">Login:</span> #{loginBean.usuarioLogado.login}</p>
                </h:form>
            </div>

            <div class="section-title">üîí Senha</div>

            <h:form id="formInfos">

                <h:panelGrid columns="2" cellpadding="10" columnClasses="form-label,form-input" style="align-items:center;">

                    <h:outputLabel value="Senha:" for="senhaVisualizada" />

                    <h:panelGroup style="display:flex; align-items:center; gap:10px;" id="painelSenha">

                        <h:outputText id="senhaVelada"
                                      value="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                      rendered="#{!usuarioBean.mostrarSenha}"
                                      style="padding:8px 12px; border:1px solid #ccc; border-radius:6px; min-width:150px; display:inline-block;" />

                        <h:outputText id="senhaRevelada"
                                      value="#{usuarioBean.senhaAtual}"
                                      rendered="#{usuarioBean.mostrarSenha}"
                                      style="padding:8px 12px; border:1px solid #ccc; border-radius:6px; min-width:150px; display:inline-block;" />

                        <h:commandButton action="#{usuarioBean.toggleMostrarSenha}"
                                         value="Mostrar"
                                         rendered="#{!usuarioBean.mostrarSenha}"
                                         styleClass="btn btn-blue">
                            <f:ajax render="painelSenha" />
                        </h:commandButton>

                    </h:panelGroup>

                </h:panelGrid>

            </h:form>

            <div class="section-title">‚úèÔ∏è Editar Dados</div>

            <h:form>

                <span class="label">Editar nome:</span>
                <h:inputText value="#{usuarioBean.novoNome}" styleClass="input-field" />
                <h:commandButton value="Salvar Nome"
                                 action="#{usuarioBean.editarNome()}"
                                 styleClass="btn btn-green" />

                <span class="label" style="margin-top:15px;">Nova senha:</span>
                <h:inputText value="#{usuarioBean.novaSenha}" styleClass="input-field" />

                <span class="label">Senha atual:</span>
                <h:inputText value="#{usuarioBean.senhaAtual}" styleClass="input-field" />

                <h:commandButton value="Salvar Senha"
                                 action="#{usuarioBean.alterarSenha()}"
                                 styleClass="btn btn-blue" />

                <div style="text-align:center; margin-top:15px;">
                    <h:outputText value="#{usuarioBean.mensagemSenha}"
                                  style="color:#e74c3c; font-weight:bold;" />
                </div>

            </h:form>
            
            <h:form>
                <h:commandButton styleClass="btn btn-blue" 
                                 value="Ver m√∫sicas favoritas" action="#{usuarioBean.irParaPaginaDeMusicas()}" />
            </h:form>

        </div>

    </ui:define>

</ui:composition>
</html>
