<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core"
                xmlns:ui="jakarta.faces.facelets"
                template="template.xhtml">

    <ui:define name="title">Gerenciamento de Bandas</ui:define>

    <ui:define name="content">

        <style>
            .page-title {
                font-size: 2.2rem;
                font-weight: bold;
                margin-bottom: 20px;
                color: #2c3e50;
                text-align: center;
            }

            .btn-primary {
                background-color: #3498db;
                color: white;
                padding: 10px 18px;
                border-radius: 8px;
                border: none;
                cursor: pointer;
                transition: 0.3s;
            }
            .btn-primary:hover {
                background-color: #2980b9;
            }

            .section-title {
                font-size: 1.4rem;
                margin-top: 30px;
                color: #34495e;
            }

            .search-grid {
                margin-top: 10px;
                background: #f7f7f7;
                padding: 15px;
                border-radius: 8px;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
                background: #fff;
            }

            th, td {
                padding: 12px;
                text-align: left;
            }

            th {
                background-color: #ecf0f1;
                font-weight: bold;
            }

            tr:nth-child(even) {
                background-color: #f9f9f9;
            }

            .btn-action {
                padding: 6px 12px;
                border-radius: 6px;
                border: none;
                cursor: pointer;
                transition: 0.3s;
            }
            .btn-view {
                background-color: #8e44ad;
                color: white;
            }
            .btn-view:hover {
                background-color: #732d91;
            }

            .btn-edit {
                background-color: #f39c12;
                color: white;
            }
            .btn-edit:hover {
                background-color: #d68910;
            }

            .btn-remove {
                background-color: #e74c3c;
                color: white;
            }
            .btn-remove:hover {
                background-color: #c0392b;
            }

            .message {
                margin-top: 20px;
                font-size: 1.1rem;
                color: red;
                font-weight: bold;
            }
        </style>

        <div rendered="#{loginBean.usuarioLogado.logado and loginBean.usuarioLogado != null}">
            <h1 class="page-title">ðŸŽµ Gerenciar Bandas</h1>

            <h:form>
                <h:commandButton value="Cadastrar Nova Banda"
                                 styleClass="btn-primary"
                                 action="#{bandaBean.irParaCadastro}" />
            </h:form>

            <h2 class="section-title">Buscar Bandas</h2>

            <h:form>
                <h:panelGrid columns="3" styleClass="search-grid">
                    <h:outputLabel value="Nome:" />

                    <h:inputText value="#{bandaBean.nome}"
                                 style="padding:6px; border-radius:6px; border:1px solid #ccc;">
                        <f:ajax event="keyup"
                                render="tabela"
                                listener="#{bandaBean.filtrar}" />
                    </h:inputText>

                    <h:commandButton value="Buscar"
                                     styleClass="btn-primary"
                                     action="#{bandaBean.filtrar}" />
                </h:panelGrid>
            </h:form>

            <!-- MENSAGENS -->
            <h:outputText value="#{bandaBean.resultadoRemocao}"
                          rendered="#{bandaBean.resultadoRemocao != null}"
                          styleClass="message" />

            <!-- TABELA -->
            <h:dataTable id="tabela"
                         value="#{bandaBean.listaFiltrada}"
                         var="banda"
                         border="1">

                <h:column>
                    <f:facet name="header">Nome</f:facet>
                    <h:outputText value="#{banda.nome}" />
                </h:column>

                <!-- MÃšSICAS -->
                <h:column>
                    <f:facet name="header">MÃºsicas</f:facet>
                    <h:form>
                        <h:commandButton value="Ver MÃºsicas"
                                         styleClass="btn-action btn-view"
                                         action="#{bandaBean.selecionar(banda)}" />
                    </h:form>
                </h:column>

                <!-- EDITAR -->
                <h:column rendered="#{loginBean.usuarioLogado.adm}">
                    <f:facet name="header">Editar</f:facet>
                    <h:form>
                        <h:commandButton value="Editar"
                                         styleClass="btn-action btn-edit"
                                         action="#{bandaBean.irParaEdicao(banda)}" />
                    </h:form>
                </h:column>

                <!-- REMOVER -->
                <h:column rendered="#{loginBean.usuarioLogado.adm}">
                    <f:facet name="header">Remover</f:facet>
                    <h:form>
                        <h:commandButton value="Remover"
                                         styleClass="btn-action btn-remove"
                                         action="#{bandaBean.remover(banda)}"
                                         onclick="return confirm('Tem certeza que deseja remover esta banda?')" />
                    </h:form>
                </h:column>

            </h:dataTable>

        </div>
    </ui:define>

</ui:composition>
